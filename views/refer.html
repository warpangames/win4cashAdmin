<%-  include("include/header.ejs") -%>

  <main id="main" class="main">
    <div class="pagetitle">
      <h1 style="text-align: center; font-size: 30px; font-weight: 900;">Refer Earn</h1>
      
    </div><!-- End Page Title -->
    <div class="d-flex" style="justify-content: flex-end;">
      <button class="btn btn-sm btn-success m-1" type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Add +</button>
    </div>
    <section class="section">
      <div class="row">
        <div class="col-lg-12">

          <div class="card">
            <div class="card-body">
            
             
              <table class="table datatable">
                <thead>
                  <tr>
                    <th scope="col">#Id</th>
                    <th scope="col">User bonus</th>
                    <th scope="col">1st Parent bonus</th>
                    <th scope="col">2nd Parent bonus</th>
                    <th scope="col">3rd Parent bonus</th>
                    
                    <th scope="col">Action</th>
                  </tr>
                </thead>
                <tbody>
                 
                </tbody>

</table>

            </div>
          </div>

        </div>
      </div>
    </section>
<!-- deltet modal -->





<div class="pagetitle">
  <h1 style="text-align: center; font-size: 30px; font-weight: 900;">Minimum Fixed Amount Should be </h1>
  
</div><!-- End Page Title -->
<div class="d-flex" style="justify-content: flex-end;">
  <button class="btn btn-sm btn-success m-1" type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal2">Add +</button>
</div>
<section class="section">
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-body">
          <!-- Table with stripped rows -->
          <table class="table datatable">
            <thead>
              <tr>
                <th scope="col">#Id</th>
                <th scope="col">Fixed Amount</th>
                <!-- <th scope="col">4rd Parent bonus</th> -->
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody>
              <% if (ReferEarnFixedAmt && ReferEarnFixedAmt.length > 0) { %>
                <td><%= ReferEarnFixedAmt[0]._id || 0 %></td>
                <td><%= ReferEarnFixedAmt[0].FixedAmount || 0 %></td>
                <td>
                  <i class="bi bi-trash text-danger delete-btn-sec" 
                  style="font-size:1.2rem;" 
                  data-index-sec="<%= ReferEarnFixedAmt[0]._id %>" 
                  data-toggle="modal" 
                  data-target="#myModalSecond">
                  </i>
                </td>
              <% } else { %>
                <td colspan="7">No data available</td>
              <% } %>
            </tbody>            
</table>

        </div>
      </div>

    </div>
  </div>
</section>
<!-- deltet modal -->



<div class="text-center">
  <!-- Button HTML (to Trigger Modal) -->
  <!-- <a >Click to Open Confirm Modal</a> -->
</div>

<!-- Modal HTML -->
<div class="de">
<div id="myModal" class="modal fade">
  <div class="modal-dialog modal-confirm">
    <div class="modal-content">
    <i class="bi bi-exclamation-circle text-danger" style="font-size:2rem"></i>
      <!-- <div class="modal-header">
        <div class="icon-box">
          <i class="bi bi-twitter-x">X</i>
          <i class="material-icons"></i>
        </div>
        <h4 class="modal-title">Are you sure?</h4>
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      </div> -->
      <div class="modal-body">
        <p>Do you really want to delete these records? This process cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger delete-modal-btn">Delete</button>
      </div>
    </div>
  </div>
</div>
</div>
<!-- deltet modal -->



<!-- Modal HTML -->
<div class="de">
  <div id="myModalSecond" class="modal fade">
    <div class="modal-dialog modal-confirm">
      <div class="modal-content">
      <i class="bi bi-exclamation-circle text-danger" style="font-size:2rem"></i>
        <!-- <div class="modal-header">
          <div class="icon-box">
            <i class="bi bi-twitter-x">X</i>
            <i class="material-icons"></i>
          </div>
          <h4 class="modal-title">Are you sure?</h4>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        </div> -->
        <div class="modal-body">
          <p>Do you really want to delete these records? This process cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-info" data-dismiss="modalsec">Cancel</button>
          <button type="button" class="btn btn-danger delete-modal-btn-sec">Delete</button>
        </div>
      </div>
    </div>
  </div>
  </div>
  <!-- deltet modal -->




<!-- START Modal ADD LOBBIES -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Bonus</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="">
          <div class="mb-3">
            <input type="number" class="form-control" id="newuser" name="newuser" placeholder="User Bonus">
          </div>
          <div class="mb-3">
            <input type="number" class="form-control" id="firstParent" name="firstParent" placeholder="1st Parent Bonus">
          </div>
          <div class="mb-3">
            <input type="number" class="form-control" id="SecondParent" name="SecondParent" placeholder="2nd Parent Bonus">
          </div>
          <div class="mb-3">
            <input type="number" class="form-control" id="ThirdParent" name="ThirdParent" placeholder="3rd Parent Bonus">
          </div>
       
          <button class="btn btn-success" type="button" onclick="submitForm(event)"   style="background-color: green; color: aliceblue;">Save</button>
       </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
      </div>
    </div>
  </div>
</div>
<!--end Modal ADD LOBBIES -->







<!-- START Modal ADD LOBBIES -->
<div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Bonus</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="">
          <div class="mb-3">
            <input type="number" class="form-control" id="ReferEarnFixedAmt" name="ReferEarnFixedAmt" placeholder="Fixed Amount">
          </div>
          <button class="btn btn-success" type="button" onclick="submitForm2(event)"   style="background-color: green; color: aliceblue;">Save</button>
       </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
      </div>
    </div>
  </div>
</div>
<!--end Modal ADD LOBBIES -->







<!-- START Modal edit LOBBIES -->
<div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Edit Bonus</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="">
          <div class="mb-3">
            <input type="number" class="form-control" id="formGroupExampleInput" value="1000">
          </div>
          <div class="mb-3">
            <input type="number" class="form-control" id="formGroupExampleInput" value="50">
          </div>
          <!-- <div class="mb-3">
            <input type="email" class="form-control" id="formGroupExampleInput" value="pavasini9852@gmail.com">
          </div>
          <div class="mb-3">
            <input type="password" class="form-control" id="formGroupExampleInput2" placeholder="Password">
          </div> -->
          <button class="btn btn-success">Save</button>
       </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
      </div>
    </div>
  </div>
</div>
<!--end Modal edit LOBBIES -->

<script>
   const submitForm = async(event)=> {
    event.preventDefault();
    const child = document.getElementById('newuser').value;
    const firstParent = document.getElementById('firstParent').value;
    const SecondParent = document.getElementById('SecondParent').value;
    const ThirdParent = document.getElementById('ThirdParent').value;
    // const FourParent = document.getElementById('FourParent').value;

    const formData = {
      child, firstParent, SecondParent ,ThirdParent 
    };
    fetch('http://localhost:5000/ReferErnData', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(formData),
    })
      .then(response => response.json())
      .then(data => {
        location.reload()
    document.getElementById('newuser').value="";
    document.getElementById('firstParent').value="";
    document.getElementById('SecondParent').value="";
    document.getElementById('ThirdParent').value="";
    // document.getElementById('FourParent').value="";
        // Enable the close button
        const closeButton = document.querySelector('.btn-secondary');
        closeButton.removeAttribute('disabled');
        // Close the modal after successful submission
        $('#exampleModal1').modal('hide');
      })
      .catch(error => console.error('Error:', error));
}



const submitForm2 = async(event)=> {
    event.preventDefault();
    const FixedAmount = document.getElementById('ReferEarnFixedAmt').value;
    const formData = {
      FixedAmount,
    };
    fetch('http://localhost:5000/ReferEarnFixedAmt', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(formData),
    })
      .then(response => response.json())
      .then(data => {
        location.reload()
    document.getElementById('ReferEarnFixedAmt').value="";
        // Enable the close button
        const closeButton = document.querySelector('.btn-secondary');
        closeButton.removeAttribute('disabled');
        // Close the modal after successful submission
        $('#exampleModal1').modal('hide');
      })
      .catch(error => console.error('Error:', error));
}





document.addEventListener('DOMContentLoaded', function () {
    // Function to handle deletion of slider image
    function deleteDailyBonus(Id) {
        const formData = {
          Id
        };
        // Send a POST request to delete the slider image
        fetch(`http://localhost:5000/DeletereReferEarn`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData),
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Failed to delete DeleteDailyBounsAmount');
            }
            else{
              location.reload()
            }
        })
        .catch(error => {
            // Handle error
            console.error('Error deleting DeleteDailyBounsAmount:', error);
        });
    }

    // Event listener for delete button clicks
    document.addEventListener('click', function (event) {
        if (event.target.classList.contains('delete-btn')) {
            const button = event.target;
            const Id = button.getAttribute('data-index');
            $('#myModal').modal('show');
            // Event listener for delete confirmations
            document.querySelector('.delete-modal-btn').addEventListener('click', function() {
                deleteDailyBonus(Id);
                // Close the modal
                $('#myModal').modal('hide');
            });
        }
    });
});






document.addEventListener('DOMContentLoaded', function () {
    // Function to handle deletion of slider image
    function deleteDailyBonus(Id) {
        const formData = {
          Id
        };
        // Send a POST request to delete the slider image
        fetch(`http://localhost:5000/DeletereReferEarnfixedData`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData),
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Failed to delete DeleteDailyBounsAmount');
            }
            else{
              location.reload()
            }
        })
        .catch(error => {
            // Handle error
            console.error('Error deleting DeleteDailyBounsAmount:', error);
        });
    }

    // Event listener for delete button clicks
    document.addEventListener('click', function (event) {
    if (event.target.classList.contains('delete-btn-sec')) {
        const button = event.target;
        // console.log(button)
        const Id = button.getAttribute('data-index-sec'); // Remove the space here
        $('#myModalSecond').modal('show');
        // Event listener for delete confirmations
        document.querySelector('.delete-modal-btn-sec').addEventListener('click', function() {
            deleteDailyBonus(Id);
            // Close the modal
            $('#myModalSecond').modal('hide');
        });
    }
});
});





</script>
  </main><!-- End #main -->
  <!-- <script src="assets/js/main.js"></script> -->
  
  <%- include("include/footer.ejs") -%>
